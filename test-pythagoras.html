<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –ö–≤–∞–¥—Ä–∞—Ç–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1f3a; color: #e8e9ed; }
        .result { background: #2a2f4a; padding: 20px; margin: 10px 0; border-radius: 8px; }
        .matrix { display: grid; grid-template-columns: repeat(3, 100px); gap: 10px; margin: 20px 0; }
        .cell { background: #1a1f3a; padding: 10px; text-align: center; border: 2px solid #c9a05f; border-radius: 5px; }
        .cell-num { color: #c9a05f; font-size: 12px; }
        .cell-val { color: #e8e9ed; font-size: 20px; font-weight: bold; }
        button { background: #c9a05f; color: #1a1f3a; border: none; padding: 10px 20px; cursor: pointer; border-radius: 5px; font-size: 16px; }
        input { padding: 10px; font-size: 16px; border-radius: 5px; border: 2px solid #c9a05f; background: #2a2f4a; color: #e8e9ed; }
    </style>
</head>
<body>
    <h1>üßÆ –¢–µ—Å—Ç –ö–≤–∞–¥—Ä–∞—Ç–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞</h1>
    
    <div>
        <label>–¢–µ—Å—Ç –¥–∞—Ç—ã:</label>
        <button onclick="testDate('28.02.1986')">28.02.1986</button>
        <button onclick="testDate('22.06.1984')">22.06.1984</button>
        <button onclick="testDate('31.03.1984')">31.03.1984</button>
    </div>
    <div>
        <input type="text" id="dateInput" placeholder="28.02.1986" value="28.02.1986">
        <button onclick="testCalculation()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
    </div>
    
    <div id="result" class="result" style="display:none;">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á—ë—Ç–∞</h2>
        <p><strong>–î–∞—Ç–∞:</strong> <span id="date"></span></p>
        <p><strong>–¶–∏—Ñ—Ä—ã –¥–∞—Ç—ã:</strong> <span id="dateDigits"></span></p>
        <p><strong>S1 (—Å—É–º–º–∞ —Ü–∏—Ñ—Ä):</strong> <span id="s1"></span></p>
        <p><strong>S2 (—Å—É–º–º–∞ —Ü–∏—Ñ—Ä S1):</strong> <span id="s2"></span> ‚Üí –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ: <span id="s2inter"></span> ‚Üí –∏—Ç–æ–≥–æ: <span id="s2single"></span></p>
        <p><strong>–ü–µ—Ä–≤–∞—è –∑–Ω–∞—á–∞—â–∞—è —Ü–∏—Ñ—Ä–∞ –¥–Ω—è:</strong> <span id="first"></span></p>
        <p><strong>S3 (S1 - 2√ó–ø–µ—Ä–≤–∞—è):</strong> <span id="s3"></span></p>
        <p><strong>S4 (—Å—É–º–º–∞ —Ü–∏—Ñ—Ä |S3|):</strong> <span id="s4"></span> ‚Üí –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ: <span id="s4inter"></span> ‚Üí –∏—Ç–æ–≥–æ: <span id="s4single"></span></p>
        <p><strong>–í—Å–µ —Ü–∏—Ñ—Ä—ã –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã:</strong> <span id="allDigits"></span></p>
        
        <h3>–ö–≤–∞–¥—Ä–∞—Ç –ü–∏—Ñ–∞–≥–æ—Ä–∞</h3>
        <div class="matrix">
            <div class="cell"><div class="cell-num">1</div><div class="cell-val" id="c1">-</div></div>
            <div class="cell"><div class="cell-num">2</div><div class="cell-val" id="c2">-</div></div>
            <div class="cell"><div class="cell-num">3</div><div class="cell-val" id="c3">-</div></div>
            <div class="cell"><div class="cell-num">4</div><div class="cell-val" id="c4">-</div></div>
            <div class="cell"><div class="cell-num">5</div><div class="cell-val" id="c5">-</div></div>
            <div class="cell"><div class="cell-num">6</div><div class="cell-val" id="c6">-</div></div>
            <div class="cell"><div class="cell-num">7</div><div class="cell-val" id="c7">-</div></div>
            <div class="cell"><div class="cell-num">8</div><div class="cell-val" id="c8">-</div></div>
            <div class="cell"><div class="cell-num">9</div><div class="cell-val" id="c9">-</div></div>
        </div>
        
        <h3>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è 28.02.1986:</h3>
        <div class="matrix">
            <div class="cell"><div class="cell-num">1</div><div class="cell-val">-</div></div>
            <div class="cell"><div class="cell-num">2</div><div class="cell-val">222</div></div>
            <div class="cell"><div class="cell-num">3</div><div class="cell-val">33</div></div>
            <div class="cell"><div class="cell-num">4</div><div class="cell-val">-</div></div>
            <div class="cell"><div class="cell-num">5</div><div class="cell-val">5</div></div>
            <div class="cell"><div class="cell-num">6</div><div class="cell-val">66</div></div>
            <div class="cell"><div class="cell-num">7</div><div class="cell-val">-</div></div>
            <div class="cell"><div class="cell-num">8</div><div class="cell-val">88</div></div>
            <div class="cell"><div class="cell-num">9</div><div class="cell-val">99</div></div>
        </div>
        
        <h3>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è 22.06.1984:</h3>
        <div class="matrix">
            <div class="cell"><div class="cell-num">1</div><div class="cell-val">111</div></div>
            <div class="cell"><div class="cell-num">2</div><div class="cell-val">2222</div></div>
            <div class="cell"><div class="cell-num">3</div><div class="cell-val">3</div></div>
            <div class="cell"><div class="cell-num">4</div><div class="cell-val">4</div></div>
            <div class="cell"><div class="cell-num">5</div><div class="cell-val">5</div></div>
            <div class="cell"><div class="cell-num">6</div><div class="cell-val">6</div></div>
            <div class="cell"><div class="cell-num">7</div><div class="cell-val">-</div></div>
            <div class="cell"><div class="cell-num">8</div><div class="cell-val">88</div></div>
            <div class="cell"><div class="cell-num">9</div><div class="cell-val">9</div></div>
        </div>
        
        <h3>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è 31.03.1984:</h3>
        <div class="matrix">
            <div class="cell"><div class="cell-num">1</div><div class="cell-val">1111</div></div>
            <div class="cell"><div class="cell-num">2</div><div class="cell-val">222</div></div>
            <div class="cell"><div class="cell-num">3</div><div class="cell-val">333</div></div>
            <div class="cell"><div class="cell-num">4</div><div class="cell-val">4</div></div>
            <div class="cell"><div class="cell-num">5</div><div class="cell-val">5</div></div>
            <div class="cell"><div class="cell-num">6</div><div class="cell-val">-</div></div>
            <div class="cell"><div class="cell-num">7</div><div class="cell-val">-</div></div>
            <div class="cell"><div class="cell-num">8</div><div class="cell-val">8</div></div>
            <div class="cell"><div class="cell-num">9</div><div class="cell-val">99</div></div>
        </div>
    </div>

    <script>
function calculatePythagoras(dateStr) {
    // dateStr —Ñ–æ—Ä–º–∞—Ç: DD.MM.YYYY

    // 1. –≤—Å–µ —Ü–∏—Ñ—Ä—ã –¥–∞—Ç—ã
    const dateDigits = dateStr.replace(/\D/g, '').split('').map(Number);

    // 2. S1 ‚Äî —Å—É–º–º–∞ –≤—Å–µ—Ö —Ü–∏—Ñ—Ä –¥–∞—Ç—ã
    const S1 = dateDigits.reduce((sum, n) => sum + n, 0);

    // 3. S2 ‚Äî —Å—É–º–º–∞ —Ü–∏—Ñ—Ä S1 (—Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É)
    const S2_original = S1.toString().split('').reduce((sum, n) => sum + Number(n), 0);
    
    // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π S2
    const S2_intermediate = [];
    let S2_temp = S2_original;
    S2_intermediate.push(S2_temp);
    
    while (S2_temp > 9) {
        S2_temp = S2_temp.toString().split('').reduce((sum, n) => sum + Number(n), 0);
        S2_intermediate.push(S2_temp);
    }
    const S2_final = S2_temp;

    // 4. –ü–ï–†–í–û–ï –ó–ù–ê–ß–ê–©–ï–ï –ß–ò–°–õ–û –î–ù–Ø (–Ω–µ –Ω–æ–ª—å!)
    const day = dateStr.split('.')[0]; // "28" –∏–ª–∏ "05"
    const dayFirstDigit = Number(day[0]); // –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª
    const daySecondDigit = Number(day[1]); // –≤—Ç–æ—Ä–æ–π —Å–∏–º–≤–æ–ª
    
    // –ï—Å–ª–∏ –ø–µ—Ä–≤–∞—è —Ü–∏—Ñ—Ä–∞ 0, –±–µ—Ä—ë–º –≤—Ç–æ—Ä—É—é —Ü–∏—Ñ—Ä—É
    const firstSignificantDigit = dayFirstDigit === 0 ? daySecondDigit : dayFirstDigit;

    // 5. S3 ‚Äî S1 ‚àí 2 √ó –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–∞—â–µ–µ —á–∏—Å–ª–æ –¥–Ω—è
    const S3_original = S1 - 2 * firstSignificantDigit;

    // 6. S4 ‚Äî —Å—É–º–º–∞ —Ü–∏—Ñ—Ä |S3| (—Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º –∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ–º—É)
    const S4_first = Math.abs(S3_original).toString().split('').reduce((sum, n) => sum + Number(n), 0);
    
    // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π S4
    const S4_intermediate = [];
    let S4_temp = S4_first;
    S4_intermediate.push(S4_temp);
    
    while (S4_temp > 9) {
        S4_temp = S4_temp.toString().split('').reduce((sum, n) => sum + Number(n), 0);
        S4_intermediate.push(S4_temp);
    }
    const S4_final = S4_temp;

    // 7. –°–æ–±–∏—Ä–∞–µ–º –í–°–ï —Ü–∏—Ñ—Ä—ã –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã
    const allDigits = [];
    
    // –¶–∏—Ñ—Ä—ã –¥–∞—Ç—ã
    dateDigits.forEach(d => allDigits.push(d));
    
    // –¶–∏—Ñ—Ä—ã S1
    S1.toString().split('').forEach(d => allDigits.push(Number(d)));
    
    // –í–°–ï –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è S2 (–≤–∫–ª—é—á–∞—è –∫–æ–Ω–µ—á–Ω–æ–µ)
    S2_intermediate.forEach(num => {
        num.toString().split('').forEach(d => allDigits.push(Number(d)));
    });
    
    // –¶–∏—Ñ—Ä—ã S3
    Math.abs(S3_original).toString().split('').forEach(d => allDigits.push(Number(d)));
    
    // –í–°–ï –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è S4 (–≤–∫–ª—é—á–∞—è –∫–æ–Ω–µ—á–Ω–æ–µ)
    S4_intermediate.forEach(num => {
        num.toString().split('').forEach(d => allDigits.push(Number(d)));
    });

    // 8. –º–∞—Ç—Ä–∏—Ü–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞
    const matrix = {
        1: "", 2: "", 3: "",
        4: "", 5: "", 6: "",
        7: "", 8: "", 9: ""
    };

    allDigits.forEach(d => {
        if (d >= 1 && d <= 9) {
            matrix[d] += d.toString();
        }
    });

    return {
        date: dateStr,
        dateDigits,
        S1,
        S2: S2_original,
        S2_final,
        S2_intermediate,
        S3: S3_original,
        S4: S4_first,
        S4_final,
        S4_intermediate,
        firstSignificantDigit,
        allDigits,
        matrix
    };
}

function testCalculation() {
    const dateInput = document.getElementById('dateInput').value;
    const result = calculatePythagoras(dateInput);
    
    document.getElementById('date').textContent = result.date;
    document.getElementById('dateDigits').textContent = result.dateDigits.join(', ');
    document.getElementById('s1').textContent = result.S1;
    document.getElementById('s2').textContent = result.S2;
    document.getElementById('s2inter').textContent = result.S2_intermediate.join(' ‚Üí ');
    document.getElementById('s2single').textContent = result.S2_final;
    document.getElementById('first').textContent = result.firstSignificantDigit;
    document.getElementById('s3').textContent = result.S3;
    document.getElementById('s4').textContent = result.S4;
    document.getElementById('s4inter').textContent = result.S4_intermediate.join(' ‚Üí ');
    document.getElementById('s4single').textContent = result.S4_final;
    document.getElementById('allDigits').textContent = result.allDigits.join(', ');
    
    for (let i = 1; i <= 9; i++) {
        document.getElementById('c' + i).textContent = result.matrix[i] || '-';
    }
    
    document.getElementById('result').style.display = 'block';
    
    console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', result);
}

function testDate(dateStr) {
    document.getElementById('dateInput').value = dateStr;
    testCalculation();
}

// Auto-test on load
window.addEventListener('load', () => {
    testCalculation();
});
    </script>
</body>
</html>
